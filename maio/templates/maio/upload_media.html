{% extends 'base/base.html' %}
{% load static %}

{% block title %}Upload Media{% endblock title %}

{% block scripts %}
  <script src="{% static 'maio/js/upload_media.js' %}"></script>
{% endblock %}

{% block script %}
  <script>
    var config = new Config({
      csrf_token: '{{ csrf_token }}',
      video_tn: '{% static "icons/tn_video.png" %}',
      audio_tn: '{% static "icons/tn_audio.png" %}',
      document_tn: '{% static "icons/tn_doc.png" %}',
      other_tn: '{% static "icons/tn_doc.png" %}',
    });
    console.log('1) Config:', config);
    document.getElementById('id_content_file').addEventListener('change', (function(evt) {
      return function(evt) {
        console.log('2) Config:', config);
        return handleFileSelect(evt, config)
      }
    })(), false);
    document.config = config;
  </script>
{% endblock %}

{% block content %}
  <div class="container"> <!-- container -->
    <h1>Upload Media</h1>
    {% if media.new %}
    <h4>Uploaded {{media.new_count}} new media</h4>
    {% endif %}
    {% for medium in media.new %}
    <div class="alert alert-success">
      <h4>Upload successful.</h4>
      <div class="row">
        <div class="col-lg">
          <img src="{{medium.get_static_thumbnail_uri}}" alt="{{medium.name}}">
        </div>
        <div class="col-lg">
          <div>File ID: {{medium.file.id}}</div>
          <div>Media ID: {{medium.id}}</div>
          <div>Name: {{medium.name}}</div>
          <div>Extension: {{medium.extension}}</div>
          <div>Date Added: {{medium.date_added}}</div>
          <div>Date Modified: {{medium.date_modified}}</div>
          <div>Width: {{medium.width}}</div>
          <div>Height: {{medium.height}}</div>
          <div>Thumbnail Width: {{medium.tn_width}}</div>
          <div>Thumbnail Height: {{medium.tn_height}}</div>
        </div>
      </div>
    </div>
    {% endfor %}
    {% if media.old %}
    <h4>Skipped {{media.old_count}} existing media</h4>
    {% endif %}
    {% for medium in media.old %}
    <div class="alert alert-warning">
      <h4>Upload skipped.</h4>
      <div class="row">
        <div class="col-lg">
          <img src="{{medium.get_static_thumbnail_uri}}" alt="{{medium.name}}">
        </div>
        <div class="col-lg">
          <div>File ID: {{medium.file.id}}</div>
          <div>Media ID: {{medium.id}}</div>
          <div>Name: {{medium.name}}</div>
          <div>Extension: {{medium.extension}}</div>
          <div>Date Added: {{medium.date_added}}</div>
          <div>Date Modified: {{medium.date_modified}}</div>
          <div>Width: {{medium.width}}</div>
          <div>Height: {{medium.height}}</div>
          <div>Thumbnail Width: {{medium.tn_width}}</div>
          <div>Thumbnail Height: {{medium.tn_height}}</div>
        </div>
      </div>
    </div>
    {% endfor %}
    <output id="list"></output>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <h3>File Form</h3>
      <div>
        {{form.as_div}}
      </div>
      <div>
        <input type="submit" name="submit" value="Upload">
      </div>
    </form>
  </div> <!-- /container -->
{% endblock content %}
